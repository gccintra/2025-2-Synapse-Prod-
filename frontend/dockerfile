# /frontend/dockerfile

# Usar a versão LTS (Long Term Support) para estabilidade
FROM node:20-alpine

WORKDIR /app

COPY package*.json ./

# Instala dependências
RUN npm ci

COPY . .

# --- FASE DE BUILD ---
# Isso cria a pasta 'dist' com HTML/CSS/JS otimizados
RUN npm run build

# Instala um servidor HTTP leve e eficiente
RUN npm install -g serve

# Ajusta permissões (boa prática)
RUN chown -R node:node /app

USER node

# Porta padrão do servidor 'serve'
EXPOSE 3000

# Inicia o servidor estático
# -s: Single Page App (resolve rotas do React)
# dist: a pasta que foi gerada no build
CMD ["serve", "-s", "dist", "-l", "3000"]